<!DOCTYPE html>
<html>
  <body>
    <h2>Local WebSocket Test</h2>
    <input id="msg" placeholder="Type message..." />
    <button onclick="sendMsg()">Send</button>
    <pre id="log"></pre>
    <script>
  const log = (msg, emoji = "üí¨") => {
    document.getElementById("log").innerHTML += `<div>${emoji} ${msg}</div>`;
  };

  const ws = new WebSocket("ws://127.0.0.1:8000/ws/testsession");

  ws.onopen = () => log("Connected ‚úÖ");
  ws.onmessage = (e) => log("Message: " + e.data, "üì®");
  ws.onerror = (err) => log("Error: " + (err.message || "unknown"), "‚ùå");
  ws.onclose = () => log("Disconnected ‚ö†Ô∏è");

  function sendMsg() {
    const val = document.getElementById("msg").value;
    const msg = {
      source: "client",
      payload: { english: val }
    };
    ws.send(JSON.stringify(msg));
    log("Sent: " + val, "‚û°Ô∏è");
  }
</script>

  </body>
</html>
